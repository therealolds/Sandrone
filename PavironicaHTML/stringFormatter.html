<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>String Formatter • Pavironica</title>
    <script>(function(){try{const t=localStorage.getItem('theme'); if(t==='light')document.documentElement.setAttribute('data-theme','light');}catch(e){}})();</script>
    <link rel="stylesheet" href="../assets/css/style.css" />
    <style>
      /* theme vars from shared CSS */
      *{box-sizing:border-box}
      body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Helvetica Neue,Arial,Noto Sans}
      header{padding:16px 20px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}
      header a{color:var(--muted);text-decoration:none;border:1px solid var(--border);padding:6px 10px;border-radius:8px}
      header a:hover{border-color:var(--accent);color:var(--text)}
      header h1{margin:0;font-size:18px;letter-spacing:.2px}
      main{padding:20px;max-width:clamp(1100px,95vw,1800px);margin:0 auto;display:grid;gap:16px}
      .card{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:12px}
      .controls{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
      label{font-size:12px;color:var(--muted)}
      textarea{width:100%;min-height:260px;resize:vertical;background:var(--input);color:var(--text);border:1px solid var(--border);border-radius:8px;padding:10px;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:12px}
      .btn{background:linear-gradient(90deg,var(--accent),var(--accent-2));border:none;color:#002b36;font-weight:600;padding:8px 14px;border-radius:8px;cursor:pointer}
      .btn:disabled{opacity:.6;cursor:not-allowed}
      .muted{color:var(--muted)}
      pre{margin:0;white-space:pre-wrap;word-break:break-word}
      .result{background:var(--result);border:1px solid var(--border);border-radius:10px;padding:12px;font-size:12px}
    </style>
  </head>
  <body>
    <header>
      <a href="../index.html">← Back</a>
      <h1>String Formatter</h1>
      <span class="muted">Lines → quoted values</span>
    </header>
    <main>
      <div class="card controls">
        <div>
          <strong>Output:</strong>
          <label><input type="radio" name="mode" value="vertical" checked /> vertical (each on new line, commas)</label>
          <label><input type="radio" name="mode" value="inline" /> inline (comma separated)</label>
        </div>
        <div>
          <strong>Quote:</strong>
          <label><input type="radio" name="quote" value="'" checked /> 'single'</label>
          <label><input type="radio" name="quote" value='"' /> "double"</label>
        </div>
        <label><input type="checkbox" id="wrap-parens" /> wrap in parentheses</label>
        <label><input type="checkbox" id="ignore-empty" checked /> ignore empty lines</label>
        <button id="btn-format" class="btn">Format</button>
      </div>

      <!-- Line Padder controls (merged from Line Padder) -->
      <div class="card controls">
        <label>Width <input id="pad-width" type="number" min="1" value="11" /></label>
        <label>Fill char <input id="pad-fill" type="text" value="0" maxlength="1" /></label>
        <label><input type="checkbox" id="pad-trim" /> trim lines</label>
        <label><input type="checkbox" id="pad-ignore-empty" checked /> ignore empty lines</label>
        <div>
          <strong>Write to:</strong>
          <label><input type="radio" name="pad-target" value="input" checked /> input</label>
          <label><input type="radio" name="pad-target" value="output" /> output</label>
        </div>
        <button id="btn-pad" class="btn">Pad</button>
      </div>

      <div class="card">
        <label>Input (one value per line)</label>
        <textarea id="input"></textarea>
      </div>

      <div class="card result">
        <div class="muted" style="margin-bottom:8px; display:flex; align-items:center; justify-content:space-between;">
          <span>Output</span>
          <button id="btn-copy-output" class="btn" style="padding:6px 10px;">Copy</button>
        </div>
        <pre id="output"></pre>
      </div>
    </main>

    <script type="module">
      import { format } from "../PavironicaJS/stringFormatter.js";
      import { padLines } from "../PavironicaJS/linePadder.js";

      const input = document.getElementById('input');
      const output = document.getElementById('output');
      const btn = document.getElementById('btn-format');
      const copyBtn = document.getElementById('btn-copy-output');
      const wrap = document.getElementById('wrap-parens');
      const ignoreEmpty = document.getElementById('ignore-empty');

      function mode() { return document.querySelector('input[name="mode"]:checked')?.value || 'vertical'; }
      function quote() { return document.querySelector('input[name="quote"]:checked')?.value || "'"; }

      btn.addEventListener('click', () => {
        try {
          const out = format(input.value, { mode: mode(), quote: quote(), wrapInParens: wrap.checked, ignoreEmpty: ignoreEmpty.checked });
          output.textContent = out;
        } catch (e) {
          output.textContent = (e && e.message) ? e.message : String(e);
        }
      });

      // Copy output to clipboard
      copyBtn?.addEventListener('click', async () => {
        const text = output.textContent || '';
        try {
          if (navigator.clipboard && navigator.clipboard.writeText) {
            await navigator.clipboard.writeText(text);
          } else {
            const ta = document.createElement('textarea');
            ta.value = text; document.body.appendChild(ta); ta.select();
            document.execCommand('copy'); document.body.removeChild(ta);
          }
          const old = copyBtn.textContent; copyBtn.textContent = 'Copied!';
          setTimeout(() => copyBtn.textContent = old, 1200);
        } catch (e) {
          const old = copyBtn.textContent; copyBtn.textContent = 'Failed';
          setTimeout(() => copyBtn.textContent = old, 1200);
        }
      });

      // Line padder wiring (uses same input/output)
      const btnPad = document.getElementById('btn-pad');
      const width = document.getElementById('pad-width');
      const fill = document.getElementById('pad-fill');
      const trim = document.getElementById('pad-trim');
      const padIgnoreEmpty = document.getElementById('pad-ignore-empty');

      btnPad.addEventListener('click', () => {
        const w = Math.max(1, parseInt(width.value, 10) || 1);
        const f = (fill.value || '0').slice(0,1);
        const target = document.querySelector('input[name="pad-target"]:checked')?.value || 'input';
        const sourceText = input.value;
        try {
          const out = padLines(sourceText, w, { fill: f, trim: !!trim.checked, ignoreEmpty: !!padIgnoreEmpty.checked });
          if (target === 'input') {
            input.value = out;
          } else {
            output.textContent = out;
          }
        } catch (e) {
          const msg = (e && e.message) ? e.message : String(e);
          if (target === 'input') input.value = msg; else output.textContent = msg;
        }
      });
    </script>
  </body>
  </html>
